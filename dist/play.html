<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Play</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel='stylesheet' href='../css/reset.css'>
<link rel="stylesheet/less" type="text/css" href="../css/my_less.css" />
<script src="../css/less.min.js" type="text/javascript"></script>
</head>
<body>
	<div id="app" class='play'>
	<div>
	名：{{d[0].name}}
	分类：{{d[0].tag}}
	发布者：{{d[0].user}}
	<video src="url+d[0].src+'.mp4'" controls="controls" id='video' autoplay ></video>
	</div>
	<div>
		<span @click='like()'>喜欢</span>
		<span @click='share()'>分享</span>
		<span @click='comment()'>评论</span>
		<a :href="url+d[0].src+'.mp4'" :download="d[0].name">下载</a>
	</div>
	<div v-if="show=='more'">
		更多推荐
	</div>
	<div v-if="show=='comment'">
		<input type='text' id='my_comment' />
		<button @click="commentTo">评论</button>
		<div v-for="i in comments">
		{{i.user}}:{{i.word}}
		</div>
	</div>
	</div>
<script src="../js/my_js.js"></script>
<script src="../js/vue.js"></script>
<script>
new Vue({
	el:"#app",
	data:{
		//根据url传参
		videoname:parse().name,
		d:null,
		url:serverIP,
		show:"more",
		comments:null,
	},
	methods:{
		like:function(){
			xhr("like/insert",{user:storageG("username"),name:this.videoname});
			alert('添加收藏成功')
		},
		share:function(){
		},
		comment:function(){
			this.show="comment";
			this.comments=xhr("comment/find",{name:this.videoname});
		},
		commentTo:function(){
			xhr("comment/insert",{user:storageG("username"),word:$id("my_comment").value,name:this.videoname});
			alert('评论成功')
		}
	},
	created:function(){
		this.d=xhr("video/find",{name:this.videoname});
	}
})
</script>
</body>
</html>
